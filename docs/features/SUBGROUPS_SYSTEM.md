# üìö –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–≥—Ä—É–ø–ø

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–≥—Ä—É–ø–ø –≤ –®–ö–ï–î –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –ø–æ–¥–≥—Ä—É–ø–ø–∞–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤. –≠—Ç–æ –∑–∞–º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É —Å –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ (subgroupCommerce, subgroupTutorial –∏ —Ç.–¥.).

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –¢–∏–ø—ã –ø–æ–¥–≥—Ä—É–ø–ø

1. **–ü—Ä–µ–¥–º–µ—Ç–Ω—ã–µ –ø–æ–¥–≥—Ä—É–ø–ø—ã** - –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É
   - –ö–∞–∂–¥—ã–π –ø—Ä–µ–¥–º–µ—Ç –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–∏ –ø–æ–¥–≥—Ä—É–ø–ø—ã
   - –°—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥–≥—Ä—É–ø–ø–∞—Ö –ø–æ —Ä–∞–∑–Ω—ã–º –ø—Ä–µ–¥–º–µ—Ç–∞–º
   
2. **–û–±—â–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø—ã** - –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –ø—Ä–µ–¥–º–µ—Ç—É
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–±—â–∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
   - –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –ø—Ä–µ–¥–º–µ—Ç–∞–º –≥—Ä—É–ø–ø—ã

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø—ã

**API Endpoint:** `POST /api/groups/{groupId}/subgroups`

```json
{
  "subjectId": "clxx123...",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, null –¥–ª—è –æ–±—â–µ–π –ø–æ–¥–≥—Ä—É–ø–ø—ã
  "name": "–ü–æ–¥–≥—Ä—É–ø–ø–∞ 1 (–ö–æ–º–º–µ—Ä—Ü–∏—è)",
  "number": 1,
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø—ã"
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `subjectId` - ID –ø—Ä–µ–¥–º–µ—Ç–∞ (null –¥–ª—è –æ–±—â–µ–π –ø–æ–¥–≥—Ä—É–ø–ø—ã)
- `name` - –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø—ã
- `number` - –ù–æ–º–µ—Ä –ø–æ–¥–≥—Ä—É–ø–ø—ã (1, 2, 3...)
- `description` - –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏

#### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –ø–æ–¥–≥—Ä—É–ø–ø—É

**API Endpoint:** `POST /api/groups/{groupId}/subgroups/{subgroupId}/students`

```json
{
  "studentIds": ["user_id_1", "user_id_2", "user_id_3"]
}
```

#### –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ –ø–æ–¥–≥—Ä—É–ø–ø—ã

**API Endpoint:** `DELETE /api/groups/{groupId}/subgroups/{subgroupId}/students?userId={userId}`

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø

**API Endpoint:** `GET /api/groups/{groupId}/subgroups?subjectId={subjectId}`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `subjectId` - –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "subgroup_id",
    "groupId": "group_id",
    "subjectId": "subject_id",
    "name": "–ü–æ–¥–≥—Ä—É–ø–ø–∞ 1",
    "number": 1,
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
    "subject": {
      "id": "subject_id",
      "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞"
    },
    "students": [
      {
        "id": "membership_id",
        "userId": "user_id",
        "user": {
          "id": "user_id",
          "name": "–ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞",
          "email": "email@example.com"
        }
      }
    ],
    "_count": {
      "students": 5
    }
  }
]
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–Ω—è—Ç–∏—è –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø–æ–¥–≥—Ä—É–ø–ø—É:

```json
{
  "subjectId": "subject_id",
  "groupId": "group_id",
  "subgroupId": "subgroup_id",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  "date": "2025-11-01",
  "startTime": "10:00",
  "endTime": "11:30"
}
```

**–í–∏–¥–∏–º–æ—Å—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:**
- –ï—Å–ª–∏ `subgroupId` —É–∫–∞–∑–∞–Ω - –∑–∞–Ω—è—Ç–∏–µ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç—ã —ç—Ç–æ–π –ø–æ–¥–≥—Ä—É–ø–ø—ã
- –ï—Å–ª–∏ `subgroupId` null - –∑–∞–Ω—è—Ç–∏–µ –≤–∏–¥—è—Ç –≤—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –≥—Ä—É–ø–ø—ã

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã

### –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ (deprecated)

```prisma
model UserGroup {
  subgroupCommerce       Int?
  subgroupTutorial       Int?
  subgroupFinance        Int?
  subgroupSystemThinking Int?
}
```

### –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

```prisma
model Subgroup {
  id          String
  groupId     String
  subjectId   String?  // null –¥–ª—è –æ–±—â–∏—Ö –ø–æ–¥–≥—Ä—É–ø–ø
  name        String
  number      Int
}

model SubgroupStudent {
  id         String
  subgroupId String
  userId     String
}
```

### –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `scripts/migrate-subgroups.ts` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:

```bash
npx tsx scripts/migrate-subgroups.ts
```

–°–∫—Ä–∏–ø—Ç:
1. –ß–∏—Ç–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –ø–æ–ª—è –ø–æ–¥–≥—Ä—É–ø–ø –∏–∑ UserGroup
2. –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ Subgroup
3. –ó–∞–ø–æ–ª–Ω—è–µ—Ç SubgroupStudent —Å–≤—è–∑—è–º–∏

## –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

- **Admin**: –°–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø
- **Admin**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –ø–æ–¥–≥—Ä—É–ø–ø–∞–º
- **Lector**: –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–¥–≥—Ä—É–ø–ø —Å–≤–æ–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
- **Student**: –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–∏—Ö –ø–æ–¥–≥—Ä—É–ø–ø
- **Mentor**: –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–¥–≥—Ä—É–ø–ø —Å–≤–æ–∏—Ö –≥—Ä—É–ø–ø

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É

```typescript
// –°–æ–∑–¥–∞—Ç—å 2 –ø–æ–¥–≥—Ä—É–ø–ø—ã –¥–ª—è –ø—Ä–µ–¥–º–µ—Ç–∞ "–ö–æ–º–º–µ—Ä—Ü–∏—è"
const subgroup1 = await fetch('/api/groups/group_id/subgroups', {
  method: 'POST',
  body: JSON.stringify({
    subjectId: 'commerce_subject_id',
    name: '–ü–æ–¥–≥—Ä—É–ø–ø–∞ 1 (–ö–æ–º–º–µ—Ä—Ü–∏—è)',
    number: 1
  })
})

const subgroup2 = await fetch('/api/groups/group_id/subgroups', {
  method: 'POST',
  body: JSON.stringify({
    subjectId: 'commerce_subject_id',
    name: '–ü–æ–¥–≥—Ä—É–ø–ø–∞ 2 (–ö–æ–º–º–µ—Ä—Ü–∏—è)',
    number: 2
  })
})
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤

```typescript
// –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –ø–µ—Ä–≤—É—é –ø–æ–¥–≥—Ä—É–ø–ø—É
await fetch('/api/groups/group_id/subgroups/subgroup1_id/students', {
  method: 'POST',
  body: JSON.stringify({
    studentIds: ['student1_id', 'student2_id', 'student3_id']
  })
})

// –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤–æ –≤—Ç–æ—Ä—É—é –ø–æ–¥–≥—Ä—É–ø–ø—É
await fetch('/api/groups/group_id/subgroups/subgroup2_id/students', {
  method: 'POST',
  body: JSON.stringify({
    studentIds: ['student4_id', 'student5_id']
  })
})
```

### –ü—Ä–∏–º–µ—Ä 3: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è –¥–ª—è –ø–æ–¥–≥—Ä—É–ø–ø—ã

```typescript
// –ó–∞–Ω—è—Ç–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–π –ø–æ–¥–≥—Ä—É–ø–ø—ã
await fetch('/api/schedules', {
  method: 'POST',
  body: JSON.stringify({
    subjectId: 'commerce_subject_id',
    groupId: 'group_id',
    subgroupId: 'subgroup1_id',  // –¢–æ–ª—å–∫–æ —ç—Ç–∞ –ø–æ–¥–≥—Ä—É–ø–ø–∞ —É–≤–∏–¥–∏—Ç –∑–∞–Ω—è—Ç–∏–µ
    date: '2025-11-05',
    startTime: '10:00',
    endTime: '11:30',
    location: '–ê—É–¥–∏—Ç–æ—Ä–∏—è 305'
  })
})
```

## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

```prisma
model Subgroup {
  id          String   @id @default(cuid())
  groupId     String
  subjectId   String?  // null = –æ–±—â–∞—è –ø–æ–¥–≥—Ä—É–ø–ø–∞ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
  name        String   // "–ü–æ–¥–≥—Ä—É–ø–ø–∞ 1", "–ü–æ–¥–≥—Ä—É–ø–ø–∞ –ö–æ–º–º–µ—Ä—Ü–∏—è" –∏ —Ç.–¥.
  number      Int      // 1, 2, 3...
  description String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  
  group       Group    @relation(fields: [groupId], references: [id], onDelete: Cascade)
  subject     Subject? @relation(fields: [subjectId], references: [id])
  students    SubgroupStudent[]
  schedules   Schedule[]
  
  @@unique([groupId, subjectId, number])
  @@map("subgroups")
}

model SubgroupStudent {
  id         String   @id @default(cuid())
  subgroupId String
  userId     String
  createdAt  DateTime @default(now())
  
  subgroup   Subgroup @relation(fields: [subgroupId], references: [id], onDelete: Cascade)
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([subgroupId, userId])
  @@map("subgroup_students")
}
```

## Best Practices

1. **–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–¥–≥—Ä—É–ø–ø** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è: "–ü–æ–¥–≥—Ä—É–ø–ø–∞ 1 (–ö–æ–º–º–µ—Ä—Ü–∏—è)", –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ "1"
2. **–ù—É–º–µ—Ä–∞—Ü–∏—è** - –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å 1, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–≥—Ä—É–ø–ø—É —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –Ω–æ–º–µ—Ä–æ–º –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞
4. **–£–¥–∞–ª–µ–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (isActive = false) –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
5. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π** - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç createdAt

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 30 –æ–∫—Ç—è–±—Ä—è 2025*
*–í–µ—Ä—Å–∏—è —Å–∏—Å—Ç–µ–º—ã: 0.1.0-alpha*


