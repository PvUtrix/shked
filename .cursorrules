# Правила для проекта SmartSchedule (Шкед)

## Контекст проекта
SmartSchedule (Шкед) - современная веб-платформа для управления расписанием занятий в университете МФТИ. 
Технологический стек: Next.js 14, React 18, TypeScript, Prisma, PostgreSQL, NextAuth.js, Tailwind CSS, Radix UI.

## Языковые требования

### Избегание англицизмов
- ВСЕГДА используйте русские термины вместо английских
- Комментарии в коде должны быть на русском языке
- Комментарии, UI текст, сообщения об ошибках - на русском языке
- Документация и README должны быть на русском языке
- Сообщения об ошибках и уведомления должны быть на русском языке

## Интернационализация (i18n)

### Критически важно:
- **ЗАПРЕЩЕНО** использовать захардкоженные русские строки в UI компонентах
- **ВСЕ** текстовые строки должны быть вынесены в файлы переводов (`messages/ru.json`)
- Используйте ключи переводов вместо прямых строковых литералов

### Структура переводов:
- Файлы переводов: `messages/ru.json`, `messages/en.json` (для будущего)
- Именование ключей: по функциональности (`admin.nav.schedule`, `student.homework.title`)
- Плоская структура файлов (не модульная)

### Использование переводов:

#### Client Components:
```typescript
'use client'
import { useTranslations } from 'next-intl'

export function MyComponent() {
  const t = useTranslations()
  return <div>{t('common.buttons.save')}</div>
}
```

#### Server Components:
```typescript
import { getTranslations } from 'next-intl/server'

export default async function MyPage() {
  const t = await getTranslations()
  return <div>{t('common.buttons.save')}</div>
}
```

### Правила:
1. **Никогда** не используйте строковые литералы с русским текстом в JSX/TSX
2. Всегда используйте `useTranslations()` в Client Components
3. Всегда используйте `getTranslations()` в Server Components
4. Добавляйте новые ключи в `messages/ru.json` при создании новых компонентов
5. Используйте интерполяцию для динамических значений: `t('user.name', { name: userName })`
6. Для вложенных объектов используйте точечную нотацию: `t('admin.nav.schedule')`

### Примеры правильного использования:

✅ Правильно:
```typescript
const t = useTranslations()
<Button>{t('common.buttons.save')}</Button>
<Label>{t('common.labels.name')}</Label>
```

❌ Неправильно:
```typescript
<Button>Сохранить</Button>
<Label>Имя</Label>
```

### Конфигурация:
- Конфигурация i18n: `i18n/config.ts`
- Провайдер переводов: `components/providers.tsx`
- Утилиты для Server Components: `i18n/request.ts`
- Язык по умолчанию: русский (`ru`)

## Архитектура проекта

### Структура папок:
- `app/` - App Router Next.js 14 (страницы и API routes)
- `components/` - React компоненты (UI компоненты в `ui/`, специфичные в `admin/`, `student/`)
- `lib/` - утилиты, конфигурация, типы
- `prisma/` - схема базы данных
- `hooks/` - кастомные React хуки
- `types/` - TypeScript типы

### Роли пользователей:
- `admin` - администратор (доступ к `/admin/*`)
- `student` - студент (доступ к `/student/*`)

### Основные сущности:
- `User` - пользователь системы
- `Group` - учебная группа
- `Subject` - предмет/дисциплина
- `Schedule` - расписание занятий
- `TelegramUser` - интеграция с Telegram
- `BotSettings` - настройки бота

## Стиль кода

### Именование:
- **Переменные**: camelCase на английском - `userName`, `createdAt`, `startTime`
- **Компоненты**: PascalCase на английском - `LoginForm`, `StudentList`, `ScheduleCalendar`
- **Константы**: UPPER_SNAKE_CASE - `MAX_FILE_SIZE`
- **CSS классы**: kebab-case - `login-form`, `submit-button`
- **API routes**: kebab-case - `/api/telegram/webhook`, `/api/schedules`

### Комментарии:
- Все комментарии на русском языке
- Объясняйте "почему", а не "что"
- Используйте `//` для однострочных, `/* */` для многострочных

### TypeScript:
- Строгая типизация обязательна
- Используйте интерфейсы для типов данных
- Экспортируйте типы из `lib/types.ts`

## Специфика проекта

### Next.js 14 App Router:
- Используйте Server Components по умолчанию
- Client Components только при необходимости (useState, useEffect, события)
- API routes в `app/api/`

### Prisma ORM:
- Схема в `prisma/schema.prisma`
- Миграции через `prisma migrate`
- Типы генерируются автоматически

### Аутентификация:
- NextAuth.js с JWT стратегией
- Роли: `admin`, `student`
- Middleware для защиты роутов

### UI/UX:
- Radix UI компоненты в `components/ui/`
- Tailwind CSS для стилизации
- Адаптивный дизайн обязателен
- Темная/светлая тема через next-themes

### Telegram интеграция:
- Webhook для получения сообщений
- Cron задачи для уведомлений
- LLM интеграция для обработки запросов

## Исключения

### Можно оставить на английском:
- Названия библиотек (React, Next.js, TypeScript, Prisma)
- Стандартные API endpoints (`/api/auth/*`)
- Переменные окружения
- Поля базы данных (если это стандарт Prisma)
- CSS классы от Radix UI
- Названия файлов конфигурации

## Проверка качества

### Перед коммитом:
1. ✅ Все комментарии на русском языке
2. ✅ UI элементы используют ключи переводов (не захардкоженные строки)
3. ✅ Сообщения об ошибках используют ключи переводов
4. ✅ Все новые строки добавлены в `messages/ru.json`
5. ✅ Названия переменных на английском (стандарт)
6. ✅ TypeScript ошибки исправлены
7. ✅ ESLint ошибки исправлены
8. ✅ Компоненты правильно типизированы
9. ✅ API routes защищены middleware
10. ✅ Client Components используют `useTranslations()`
11. ✅ Server Components используют `getTranslations()`

### Тестирование:
- Проверяйте работу на разных ролях (admin/student)
- Тестируйте Telegram интеграцию
- Проверяйте адаптивность на мобильных устройствах
